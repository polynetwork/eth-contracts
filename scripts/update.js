const { ethers } = require("hardhat");
const hre = require("hardhat");
const fs = require("fs");
const Web3 = require("web3");
const colors = require('colors');
const { expect } = require("chai");
hre.web3 = new Web3(hre.network.provider);

async function main() {

  [deployer] = await hre.ethers.getSigners();

  let polyId;
  let _eccd;
  let _old_ccm;
  let _ccmp;
  let fromContractWhiteList;
  let contractMethodWhiteList;

  // check polyId
  await getPolyChainId().then((_polyId) => {
    polyId = _polyId;
    console.log("\nUpdate EthCrossChainManager on chain with Poly_Chain_Id:".cyan, _polyId);
  }).catch((error) => {
    throw error;
  });;

  try {
    [_eccd, _old_ccm, _ccmp] = getDeployedContract(polyId);
  } catch(error) {
    throw error;
  }

  try {
    [fromContractWhiteList,contractMethodWhiteList] = getWhiteListInfo(polyId);
  } catch(error) {
    throw error;
  }

  const ECCD = await hre.ethers.getContractFactory("EthCrossChainData");
  const CCM = await hre.ethers.getContractFactory("EthCrossChainManager");
  const CCMP = await hre.ethers.getContractFactory("EthCrossChainManagerProxy");
  
  let eccd = ECCD.attach(_eccd);
  let old_ccm = CCM.attach(_old_ccm);
  let ccmp = CCMP.attach(_ccmp);

  // check if given contracts are valid
  expect(await old_ccm.chainId()).to.equal(polyId);
  expect(await eccd.owner()).to.equal(old_ccm.address);
  expect(await old_ccm.owner()).to.equal(ccmp.address);
  //expect(await ccmp.getEthCrossChainManager()).to.equal(old_ccm.address);
  expect(await hre.web3.eth.getStorageAt(ccmp.address,1)).to.equal('0x000000000000000000000000'+old_ccm.address.slice(2).toLowerCase());
  expect(await old_ccm.EthCrossChainDataAddress()).to.equal(eccd.address);

  console.log("Start , deployer:".cyan, deployer.address.blue);

  // deploy EthCrossChainManager
  console.log("\ndeploy new EthCrossChainManager ......".cyan);
  let ccm = await CCM.deploy(eccd.address, polyId, fromContractWhiteList, contractMethodWhiteList);
  await ccm.deployed();
  console.log("New EthCrossChainManager deployed to:".green, ccm.address.blue);

  // transfer ownership
  console.log("\ntransfer new ccm's ownership to ccmp ......".cyan);
  tx = await ccm.transferOwnership(ccmp.address);
  await tx.wait();
  expect(await ccm.owner()).to.equal(ccmp.address);
  console.log("ownership transferred".green);

  // paused
  console.log("\nCheck if paused and pause if not".cyan);
  let paused_1 = await ccmp.paused();
  let paused_2 = await old_ccm.paused();
  if (!paused_1 && paused_2) {
    tx = await ccmp.pause();
    await tx.wait();
  } else if (!paused_1 && !paused_2) {
    tx = await ccmp.pauseEthCrossChainManager();
    await tx.wait();
  } else if (paused_1 && !paused_2) {
    tx = await ccmp.unpause();
    await tx.wait();
    tx = await ccmp.pauseEthCrossChainManager();
    await tx.wait();
  }
  expect(await ccmp.paused()).to.equal(true);
  expect(await old_ccm.paused()).to.equal(true);
  console.log("all paused".green);

  // update to new
  console.log("\nUpdate to new ccm".cyan);
  tx = await ccmp.upgradeEthCrossChainManager(ccm.address);
  await tx.wait();
  expect(await eccd.owner()).to.equal(ccm.address);
  expect(await ccm.owner()).to.equal(ccmp.address);
  expect(await hre.web3.eth.getStorageAt(ccmp.address,1)).to.equal('0x000000000000000000000000'+ccm.address.slice(2).toLowerCase());
  expect(await ccm.EthCrossChainDataAddress()).to.equal(eccd.address);
  console.log("updated".green);

  // unpaused
  console.log("\nUnpaused all".cyan);
  tx = await ccmp.unpauseEthCrossChainManager();
  await tx.wait();
  expect(await ccmp.paused()).to.equal(false);
  expect(await ccm.paused()).to.equal(false);
  console.log("unpaused".green);
 
  console.log("\nDone.\n".magenta);

}

function getDeployedContract(polyId) {
  switch (polyId) {
    case 2 : //eth
      eccd = '0xcf2afe102057ba5c16f899271045a0a37fcb10f2';
      ccm = '0xe020877e67CfAAFFC33a6E7eB9e85741bbb3eA79';
      ccmp = '0x5a51e2ebf8d136926b9ca7b59b60464e7c44d2eb';
      return [eccd, ccm, ccmp];

    case 6 : //bsc
      eccd = '0x11e2A718d46EBe97645b87F2363AFE1BF28c2672';
      ccm = '0x00EeE7b864062c40F8096f948a2B0Db3c28aa6fE';
      ccmp = '0xABD7f7B89c5fD5D0AEf06165f8173b1b83d7D5c9';
      return [eccd, ccm, ccmp];

    case 7 : //heco
      eccd = '0x11e2A718d46EBe97645b87F2363AFE1BF28c2672';
      ccm = '0x59A2C3062D9F1097D5CD239FA1BAbE6cb64fB96C';
      ccmp = '0xABD7f7B89c5fD5D0AEf06165f8173b1b83d7D5c9';
      return [eccd, ccm, ccmp];

    case 12 : //ok
      eccd = '0xdb3A0149f3155cC1B6890FE382d309dB4b322630';
      ccm = '0x3758fD8D5c29AD2620De837Da7531Bb4d1f64EDc';
      ccmp = '0x4739fe955BE4704BcB7d6a699823F5B29217Baf6';
      return [eccd, ccm, ccmp];

    case 17 : //polygon
      eccd = '0x7cea671dabfba880af6723bddd6b9f4caa15c87b';
      ccm = '0x39Cd00c5d0fa3e880B86B6a76224a18128DE89E5';
      ccmp = '0x5366ea2b5b729ff3cef404c2408c8c60cc061b71';
      return [eccd, ccm, ccmp];

    case 19 : //arbitrum
      eccd = '0x11e2A718d46EBe97645b87F2363AFE1BF28c2672';
      ccm = '0x7ceA671DABFBa880aF6723bDdd6B9f4caA15C87B';
      ccmp = '0xABD7f7B89c5fD5D0AEf06165f8173b1b83d7D5c9';
      return [eccd, ccm, ccmp];

    default :
    throw new Error("fail to get DeployedContract, unknown Network: "+polyId);
  }
}

function getWhiteListInfo(polyId) {
  switch (polyId) {
    case 2 : //eth
      fromContractWhiteList = [
        '0x250e76987d838a75310c34bf422ea9f1AC4Cc906',
        '0xaf83ce8d461e8834de03a3803c968615013c6b3d',
        '0x2cdfc90250EF967036838DA601099656e74bCfc5',
        '0x9a016ce184a22dbf6c17daa59eb7d3140dbd1c54'
      ];
      contractMethodWhiteList = [
        '0x000000000000000000000000250e76987d838a75310c34bf422ea9f1ac4cc9060000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000006756e6c6f636b0000000000000000000000000000000000000000000000000000',
        '0x0000000000000000000000002cdfc90250ef967036838da601099656e74bcfc50000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000006756e6c6f636b0000000000000000000000000000000000000000000000000000',
        '0x0000000000000000000000009a016ce184a22dbf6c17daa59eb7d3140dbd1c5400000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000000c616464457874656e73696f6e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f72656d6f7665457874656e73696f6e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d72656769737465724173736574000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006756e6c6f636b0000000000000000000000000000000000000000000000000000'
      ];
      return [fromContractWhiteList,contractMethodWhiteList];

    case 6 : //bsc
      fromContractWhiteList = [
        '0x2f7ac9436ba4B548f9582af91CA1Ef02cd2F1f03',
        '0x00b93851e3135663AAeC351555EddEE5B01325e6',
        '0x2cdfc90250EF967036838DA601099656e74bCfc5',
        '0xb5d4f343412dc8efb6ff599d790074d0f1e8d430',
        '0x6B7C026621d53d092FB446C2162D1DFc048bC9D7',
        '0xf14a7d43bedaC1C17Da9C22cf3D8c900AA8DEcA9',
        '0x9800c0EB44cCb5423bb95205921fCb5FFa066a62',
        '0xa61E289C29c47A2EEA7092355602De8A0dCB16e2',
        '0x3803e2A56F657922b76211ab22eAFE6C0Aa4F95f',
        '0x303E57962D735A8dfC7CA5d30676d48A63AF7338',
        '0x5601D189D5751e4f9dde2E598999228B4a5DB9e2',
        '0x58EEac66d46d90Cc1c563CABc2c77D610B91284c',
        '0xd397a9F470212d419AcEC535783aeD8145E58853',
        '0xaeD9013944dFD09a16e5c4115ce45c48520383CE',
        '0xB8c221dc3EE9132015AE6816cEF428089498fB82',
        '0x6cE07781968c5f4747AcDd46D0975A797a8B1143',
        '0x54CF38E6B75859cD7958d3B7bc020a1b89482d7E',
        '0xc7d0d0E5bcfe73799EEcc1aD7204e9c52ea014eC',
        '0x19630C41EeD3d437348FF8A6ddcB9FAcF550AC41'
      ];
      contractMethodWhiteList = [
        '0x0000000000000000000000002f7ac9436ba4b548f9582af91ca1ef02cd2f1f030000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000006756e6c6f636b0000000000000000000000000000000000000000000000000000',
        '0x0000000000000000000000002cdfc90250ef967036838da601099656e74bcfc50000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000006756e6c6f636b0000000000000000000000000000000000000000000000000000',
        '0x000000000000000000000000b5d4f343412dc8efb6ff599d790074d0f1e8d43000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000000c616464457874656e73696f6e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f72656d6f7665457874656e73696f6e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d72656769737465724173736574000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006756e6c6f636b0000000000000000000000000000000000000000000000000000',
        '0x0000000000000000000000006b7c026621d53d092fb446c2162d1dfc048bc9d7000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000f14a7d43bedac1c17da9c22cf3d8c900aa8deca9000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000009800c0eb44ccb5423bb95205921fcb5ffa066a62000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000a61e289c29c47a2eea7092355602de8a0dcb16e2000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000003803e2a56f657922b76211ab22eafe6c0aa4f95f000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000303e57962d735a8dfc7ca5d30676d48a63af7338000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000005601d189d5751e4f9dde2e598999228b4a5db9e2000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x00000000000000000000000058eeac66d46d90cc1c563cabc2c77d610b91284c000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000d397a9f470212d419acec535783aed8145e58853000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000aed9013944dfd09a16e5c4115ce45c48520383ce000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000b8c221dc3ee9132015ae6816cef428089498fb82000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000006ce07781968c5f4747acdd46d0975a797a8b1143000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x00000000000000000000000054cf38e6b75859cd7958d3b7bc020a1b89482d7e000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000c7d0d0e5bcfe73799eecc1ad7204e9c52ea014ec000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x00000000000000000000000019630c41eed3d437348ff8a6ddcb9facf550ac41000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000'
      ];      
      return [fromContractWhiteList,contractMethodWhiteList];

    case 7 : // heco
      fromContractWhiteList = [
        '0x020c15e7d08A8Ec7D35bCf3AC3CCbF0BBf2704e6',
        '0xD98Ee7Ca1B33e60C75E3cd9493c566fc857592c8',
        '0x2cdfc90250EF967036838DA601099656e74bCfc5',
        '0xA38a2038136a57B6B1019a50A91Ab66738905a8A',
        '0xfa8440025d7EE21925be5A4adfd4aC35A156e0ed',
        '0x8b963E30f67C9a6C3F88306e799Fe2bBC3626f2E',
        '0xdf42B52157c10aaD666886dB0AB8Bb99b6485ae6',
        '0xAfFb645d73A784Ab53D074488349fF4dC22D3435',
        '0x93D3B6713c08F50C576490c7C975E1D315927EF3',
        '0x6F5E4F841DAbEac07A9270cdD26421aA869A59Bb',
        '0x64840C731022E51b20Dc5aeA6180F1b2299b5De1',
        '0x5C3CD4846d07548020eD9F40a08Fd66D16f71fE7',
        '0xB6626Eb5BB5918D01593Ad8504E4513f4385b62b',
        '0x5902BDbB4FDD0d44e2871577eaA46Fd0b3424B3e',
        '0xb4F8FeBb7372F47bEa2B06B6F9D878093a3B014E',
        '0x22A3f421115FbF2eda8AbCb56CE63219481C2A6C',
        '0x37De929B55B811FEe16a9244a0De6aac008c3F3C',
        '0xC5293535d05A98f73f5e2Af9A804363FA39BE5f3'
      ];
      contractMethodWhiteList = [
        '0x000000000000000000000000020c15e7d08a8ec7d35bcf3ac3ccbf0bbf2704e60000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000006756e6c6f636b0000000000000000000000000000000000000000000000000000',
        '0x0000000000000000000000002cdfc90250ef967036838da601099656e74bcfc50000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000006756e6c6f636b0000000000000000000000000000000000000000000000000000',
        '0x000000000000000000000000a38a2038136a57b6b1019a50a91ab66738905a8a000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000fa8440025d7ee21925be5a4adfd4ac35a156e0ed000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000008b963e30f67c9a6c3f88306e799fe2bbc3626f2e000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000df42b52157c10aad666886db0ab8bb99b6485ae6000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000affb645d73a784ab53d074488349ff4dc22d3435000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x00000000000000000000000093d3b6713c08f50c576490c7c975e1d315927ef3000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000006f5e4f841dabeac07a9270cdd26421aa869a59bb000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x00000000000000000000000064840c731022e51b20dc5aea6180f1b2299b5de1000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000005c3cd4846d07548020ed9f40a08fd66d16f71fe7000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000b6626eb5bb5918d01593ad8504e4513f4385b62b000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000005902bdbb4fdd0d44e2871577eaa46fd0b3424b3e000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000b4f8febb7372f47bea2b06b6f9d878093a3b014e000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x00000000000000000000000022a3f421115fbf2eda8abcb56ce63219481c2a6c000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x00000000000000000000000037de929b55b811fee16a9244a0de6aac008c3f3c000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000c5293535d05a98f73f5e2af9a804363fa39be5f3000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000'
      ];      
      return [fromContractWhiteList,contractMethodWhiteList];

    case 12 : // ok
      fromContractWhiteList = [
        '0x9a3658864Aa2Ccc63FA61eAAD5e4f65fA490cA7D',
        '0x6d981C8535af305915c7eC2FceFA126d6286c0F5',
        '0xA7FeD91A00fE5847cc4970a1122fA5bCf2700291',
        '0x8b0963Ac00776111160f9bAB0E1835719ce5ff6C',
        '0x1ee6dCa80F09E7d387DbFA8EB2Dea08e83FaD182',
        '0xBe7F5e9eC0b1911251D61Ac64860a315a5185A18',
        '0xA08584E87703Da3E454133080362FfBE545dEf11',
        '0xf2575b39ADF3fC2d9370862e17efDCC79D935c00',
        '0xaca1227d3526D78a7Df361dF3495Aa2A64042808',
        '0xdE8B716F43dcD94e4D4afE73D040825b2E990E6D',
        '0x35b161F6F1Aa5787045505bd2E8307195485725D',
        '0xf195EeC267130FFF260b107a26b94976f59e09e2',
        '0x353881c2afda8D07Db6c01f59D91Bef75570d4D2',
        '0xA86E17e1B40F251d50Ce64Da1f2F824Ff9520E44',
        '0xE5bbC1FaF1dD83251B2949c08dE53Ba86BFf4Fb8',
        '0x5CB3Ff30Ae417fddC9301b64C35A211f40f801C2'
      ];
      contractMethodWhiteList = [
        '0x0000000000000000000000009a3658864aa2ccc63fa61eaad5e4f65fa490ca7d0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000006756e6c6f636b0000000000000000000000000000000000000000000000000000',
        '0x0000000000000000000000006d981c8535af305915c7ec2fcefa126d6286c0f5000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000a7fed91a00fe5847cc4970a1122fa5bcf2700291000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000008b0963ac00776111160f9bab0e1835719ce5ff6c000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000001ee6dca80f09e7d387dbfa8eb2dea08e83fad182000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000be7f5e9ec0b1911251d61ac64860a315a5185a18000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000a08584e87703da3e454133080362ffbe545def11000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000f2575b39adf3fc2d9370862e17efdcc79d935c00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000aca1227d3526d78a7df361df3495aa2a64042808000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000de8b716f43dcd94e4d4afe73d040825b2e990e6d000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x00000000000000000000000035b161f6f1aa5787045505bd2e8307195485725d000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000f195eec267130fff260b107a26b94976f59e09e2000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000353881c2afda8d07db6c01f59d91bef75570d4d2000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000a86e17e1b40f251d50ce64da1f2f824ff9520e44000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000e5bbc1faf1dd83251b2949c08de53ba86bff4fb8000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000005cb3ff30ae417fddc9301b64c35a211f40f801c2000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000'
      ];      
      return [fromContractWhiteList,contractMethodWhiteList];

    case 17 : // polygon
      fromContractWhiteList = [
        '0x28ff66a1b95d7cacf8eded2e658f768f44841212',
        '0xaC57280B3A657A2e8D1180493C519a476D208F61',
        '0xf14a7d43bedaC1C17Da9C22cf3D8c900AA8DEcA9',
        '0x9800c0EB44cCb5423bb95205921fCb5FFa066a62',
        '0xa61E289C29c47A2EEA7092355602De8A0dCB16e2',
        '0x3803e2A56F657922b76211ab22eAFE6C0Aa4F95f',
        '0x303E57962D735A8dfC7CA5d30676d48A63AF7338',
        '0x5601D189D5751e4f9dde2E598999228B4a5DB9e2',
        '0xaca1227d3526D78a7Df361dF3495Aa2A64042808',
        '0xdE8B716F43dcD94e4D4afE73D040825b2E990E6D',
        '0x35b161F6F1Aa5787045505bd2E8307195485725D',
        '0x2d7Fe908524180D17C058e6C5388738C1b30d198',
        '0x487Fd5C13f5764b798D4AecaEA79B2e0DF5d3952',
        '0x1B49485342C38C83f5376efF64800b52ee35787F',
        '0x6e4475B49f5b2d0f06D6B7218C80C2A588252889',
        '0x039DB2Fc6377b20A30ac9F05eb6477ce7461cB0b',
        '0x32cAf282bdb48147C157285E0eb715fbFa07826a'
      ];
      contractMethodWhiteList = [
        '0x00000000000000000000000028ff66a1b95d7cacf8eded2e658f768f448412120000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000006756e6c6f636b0000000000000000000000000000000000000000000000000000',
        '0x000000000000000000000000f14a7d43bedac1c17da9c22cf3d8c900aa8deca9000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000009800c0eb44ccb5423bb95205921fcb5ffa066a62000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000a61e289c29c47a2eea7092355602de8a0dcb16e2000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000003803e2a56f657922b76211ab22eafe6c0aa4f95f000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000303e57962d735a8dfc7ca5d30676d48a63af7338000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000005601d189d5751e4f9dde2e598999228b4a5db9e2000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000aca1227d3526d78a7df361df3495aa2a64042808000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000de8b716f43dcd94e4d4afe73d040825b2e990e6d000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x00000000000000000000000035b161f6f1aa5787045505bd2e8307195485725d000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000002d7fe908524180d17c058e6c5388738c1b30d198000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000487fd5c13f5764b798d4aecaea79b2e0df5d3952000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000001b49485342c38c83f5376eff64800b52ee35787f000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x0000000000000000000000006e4475b49f5b2d0f06d6b7218c80c2a588252889000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x000000000000000000000000039db2fc6377b20a30ac9f05eb6477ce7461cb0b000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000',
        '0x00000000000000000000000032caf282bdb48147c157285e0eb715fbfa07826a000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f6f6e43726f73735472616e736665720000000000000000000000000000000000'
      ];
      return [fromContractWhiteList,contractMethodWhiteList];

    case 19 : // arbitrum
      fromContractWhiteList = [
        '0x2f7ac9436ba4B548f9582af91CA1Ef02cd2F1f03',
        '0x7E418a9926c8D1cbd09CC93E8051cC3BbdfE3854'
      ];
      contractMethodWhiteList = [
        '0x0000000000000000000000002f7ac9436ba4b548f9582af91ca1ef02cd2f1f030000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000006756e6c6f636b0000000000000000000000000000000000000000000000000000'
      ];
      return [fromContractWhiteList,contractMethodWhiteList];

    default :
      throw new Error("fail to get WhiteListInfo, unknown Network: "+polyId);
  }
}

async function getPolyChainId() {
  const chainId = await hre.web3.eth.getChainId();
  switch (chainId) {
    
    // mainnet
    case 1: // eth-main
      return 2;
    case 56: // bsc-main
      return 6;
    case 128: // heco-main
      return 7;
    case 137: // polygon-main
      return 17;
    case 66: // ok-main
      return 12;
    case 1718: // plt-main
      return 8;
    case 42161: // arbitrum-main
      return 19;

    // testnet
    case 3: // eth-test
      return 2;
    case 97: // bsc-test
      return 79;
    case 256: // heco-test
      return 7;
    case 80001: // polygon-test
      return 202;
    case 65: // ok-test
      return 200;
    case 101: // plt-test
      return 107;
    case 421611: // arbitrum-test
      return 205;

    // hardhat devnet
    case 31337:
      return 77777;

    // unknown chainid
    default: 
      throw new Error("fail to get Poly_Chain_Id, unknown Network_Id: "+chainId);
  }
}

// We recommend this pattern to be able to use async/await everywhere
// and properly handle errors.
main()
  .then(() => process.exit(0))
  .catch((error) => {
    console.error(error);
    process.exit(1);
  });

